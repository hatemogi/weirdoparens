# 문제

> 정해진 문법의 괄호식 한 줄을 입력받아서 규칙대로 풀어 해를 구해 출력하는 계산기를 작성하세요.

## 문법 구성 요소

아래는 `별난 괄호식`  문법 구성요소 전부이다. (이 외의 문자는 없다)

| 타입 | 실제 문자 | 설명 |
| --- | --- | --- |
| 숫자 | 0, 1, 2, 3, ... 9  | 한 자릿수 음이 아닌 정수.  |
| 함수 | +, -, *, - |  사칙연산을 수행하는 함수(연산자)|
| 분기 | ? |  조건에 따라 두 값 중 하나를 취하는 연산|
| 선언 | ! | 지역 변수를 선언 |
| 심볼 | a, b, c, ...z |  알파벳 소문자 한글자 |
| 괄호 | (, ) | 함수(연산자) 와 인수(피연산자) 그룹을 묶는 단위. 결국 하나의 숫자값으로 평가된다. |
| 공백 | ` ` | 함수(연산자) 와 인수들을 구분지어주는 공백문자|


## 규칙1. 숫자값은 숫자값 그대로 평가한다.

```
숫자값은 평가해도 그대로 숫자값이 나온다. (= 더 이상 평가되지 않는다)
```

| 입력 | 계산  | 설명 |
| --- | --- | --- |
| 3 | 3 | 입력값이 3이면 계산결괏값도 3이다 |

### 출제의도

이는 사실 재귀 종료 조건이다.


## 규칙2. 괄호안 함수에 인수를 전달해 평가한다.


### 형식

```
(함수 인수1 인수2)
```

그리고, 인수 자리에는 다른 괄호식이 올 수 있다. (재귀)

### 예제

| 입력 | 계산  | 설명 |
| --- | --- | --- | 
| ( + 6 2) | 8 | 덧셈 함수 `+` 에 6과 2를 전달하면 결괏값 8이 나온다.|
| (* 3 2) | 6 |  곱셈 함수 `*` 에 3과 2를 전달하면 결괏값 6이 나온다. |
| (- 6 2) | 4 | 뺄셈 함수 `-` 에 6과 2를 전달하면 결괏값 4가 나온다.|
| (- 2 5) | -3 | 뺄셈 함수 `-` 에 2와 5를 전달하면 결괏값 -3이 나온다.|
| (/ 6 2) | 3 | 나눗셈 함수 `/`에 6과 2를 전달하면 결괏값 3이 나온다.|
| (/ 6 0) | E | 0으로 나눌 수 없으므로 오류라는 뜻으로 `E`를 출력한다. |
| (+ (* 2 3) 2) | 8 | 바깥 괄호식 +의 첫번째 인수가 안쪽 괄호식이고, 두번 째 인수가 2이다. <br>즉, 덧셈을 하는데, 안쪽 괄호식의 계산값인 6과 2를 더해서, 최종 결괏값이 8이 된다. |
| (/ (* 2 3) (- 4 2)) | 3 | 두번 째 인수 역시 괄호식이 올 수 있다.|
| (* (/ 2 (- 2 2)) 3) | E | 사칙연산의 피연산자 중 하나라도 E이면 평가값은 E이다.|

### 출제의도

이는 사실 프로그램의 **함수 호출**이다.


## 규칙3. 조건에 따라 둘 중 하나의 값으로 평가한다.

```
(? 조건식 참식 거짓식)
```

물음표 연산은, 첫번째 인수(조건식)의 결괏값에 따라, 조건식 평가값이 양수이면 '참식'의 값을, 0이하의 정수이면 '거짓식' 값으로 평가한다.

### 예제

| 입력 | 출력  | 설명 |
| --- | --- | --- | 
| (? 0 3 4)| 4 | 조건식 평가값이 0이므로, 거짓식 평가값인 4가 결괏값이다.|
| (? 1 3 4)| 3 | 조건식 평가값이 1이므로, 참식 평가값인 3이 결괏값이다. |
| (? (* 2 3) (- 1 2) (+ 1 2))| -1 | 조건식 평가값이 6이므로, 참식 평가값인 -1이 결괏값이다. |
| (* (? 1 2 3) 3) | 6 | 안쪽의 조건식 평가값이 2이고, 거기에 3을 곱하면 결괏값은 6이다.|

### 출제의도 

이는 사실 프로그램의 **if문**이다.


## 규칙4. 지역 변수 선언 


```
(! 심볼 바인딩식 평가식)
```

!구문은, 알파벳 한 글자짜리 심볼에다가 바인딩 식을 평가한 값을 기억했다가, 평가식에서 해당 심볼을 만나면 그 값으로 대체해 준다. 로컬 변수(상수) 개념.

| 입력 | 출력  | 설명 |
| --- | --- | --- | 
| (! a 3 a) | 3 | a에 3을 바인딩하고 a를 평가했으므로 3이다|
| (! a 3 (+ a 2)) | 5 | a에 3을 바인딩하고 a에 2을 더하는 식을 평가했으므로 5다|
| (! a (* 2 3) (* a a)) | 36 | a에 (* 2 3)을 바인딩하고 a 제곱을 평가했으므로 36이 나온다|
| (! a 3 (! b 2 (+ a b))) | 5 | a에 3을 바인딩한 식 안쪽에서 b에는 2를 바인딩하고 a와 b를 더했으므로, 결괏값은 5다|
| (! a 3 (+ (! a 2 (* a 3)) a)) | 9 | a에 3을 바인딩한식에서 다시 같은 심볼 a를 2로 바인딩하면,<br> 안쪽 바인딩이 우선하여 2로 평가되어 (* a 3)은 6이 되고,<br/> 거기에 a(바깥 범위)가 더해지면 9가 된다.|


### 출제의도

이는 사실 프로그램의 **지역변수** 개념이다. 람다대수의 알파컨버전.

# 출제 의도

> 생소한 문제를 이해하는 능력을 가늠하고, 이해한 문제를 코드로 구현하는 능력을 점검하며, 간단한 재귀를 구현할 수 있는지 가름.

사실 이 문제의 내용은, 튜링머신과 호환되는 람다대수(Lambda calculus) 풀이의 일부분입니다. 조금 더 확장하면 범용 프로그래밍 언어를 만들 수 있습니다. 계산기라고 표현했지만, 결과적으로 아주 간단한 Lisp 계열 프로그래밍 언어의 인터프리터를 만드는 꼴입니다.

간단한 스캐너를 만들고 구문트리를 만든 뒤 재귀로 풀 수 있는데요, 문제의 제약 조건을 잘 읽어보면, 모든 토큰이 한 글자로 구성돼 있어서 스캐너를 만들기 간단합니다. 게다가 모든 연산자가 앞에 나오고, 각 연산자 마다 피연산자 수가 정해져 있으므로, 사실 괄호도 무시해도 됩니다. **즉, 공백과 괄호를 다 제거하고 분석을 시작**하면 훨씬 간단하게 문제를 풀 수 있습니다. 이 사실을 파악하지 못하면, 더 수고스럽게 풀어야 합니다만, 못 푸는 것은 아닙니다.

지역 변수를 실제 값으로 대체하기 위해서는 심볼테이블을 두어야 하고, 해당 심볼 테이블은 중첩이 가능해야, 같은 심볼명이 겹친 경우에 영역마다 적절한 값으로 대체할 수 있을 것입니다. 단순히 계산하는 부분과, 심볼테이블 같은 문맥을 관리하는 부분을 잘 구분 설계하여 문제를 푸는 능력을 평가할 수 있습니다.


# 풀이

## 채점 기준 및 채점을 위한 Test Case

1. (10점) 숫자값 풀이 
1. (20점) 사칙연산 풀이 
1. (10점) 조건문 풀이 
1. (20점) 중첩 사칙연산 + 조건식 풀이 (재귀 적용 확인)
1. (20점) 심볼식 풀이 (알파 컨버젼)
1. (10점) 중첩 심볼식 풀이 (동일 심볼에 대해 로컬 스코프 적용이 잘되었나?) 
1. (10점) Divide by zero 예외 처리 단순화 확인 (예외 전파를 적용했나?) - **채점자가 검사**
1. (옵션) 람다 풀이 (베타 리덕션) - 시간제약상 풀기 어려울 듯 합니다. 문제지가 길어지면 아예 생략 가능

7번을 제외하면 테스트케이스로 채점 가능하겠습니다.

## 문제 풀이를 쉽게(또는 어렵게)하는 장치

* 풀어야 할 모든 문제는 문법적으로 옳다. (문법 예외 처리 부담 없애기)
* 모든 문제를 풀면 하나의 정수값이 반드시 도출 된다. 
* 모든 입력 숫자는 한 자리수 자연수이다. (0~9)
* 모든 문제의 계산 중간값과 최종값은 32비트 범위를 넘지 않는 정수 또는 "E"(계산식에 0으로 나누는 경우가 있으면) 이다.
* (너무 어려울 것 같다면) 구문 분석기 만드는 절차를 안내한다.
* (너무 쉬울 것 같다면) 람다식(베타 리덕션)도 풀게한다.

